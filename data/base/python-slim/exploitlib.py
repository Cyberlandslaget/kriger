#  SPDX-License-Identifier: AGPL-3.0-only
#  Copyright Authors of kriger

## FOR EXPLOITS: DO NOT EDIT ##

# This file will be automatically included in the base image and thus,
# changes are ignored by default in the exploit template. If you REALLY
# need to edit this file, remove the exclusion from .dockerignore in the
# exploit.

import json
import os

from typing import Any, Callable


# The exploit itself will be provided as a function to allow support for other execution models in the future
def run(func: Callable[[str, Any | None], None]) -> None:
    ip = os.getenv("IP")
    hint = os.getenv("HINT")

    assert ip is not None
    if hint is not None:
        hint = json.loads(hint)

    func(ip, hint)
